"use strict";(self.webpackChunkdev_blink_sv=self.webpackChunkdev_blink_sv||[]).push([[226],{417:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>x,contentTitle:()=>y,default:()=>f,frontMatter:()=>g,metadata:()=>m,toc:()=>v});var a=t(4848),r=t(5680),i=t(1276),l=t(2108),o=t(230),s=t(8415),c=t(6540),p=t(4325),d=t(2556);function u(){const{authToken:e,apiEndpoint:n,accountWalletId:t,setAccountWalletId:r,paymentRequest:l,setPaymentRequest:o}=(0,i.A)(),[s,u]=(0,c.useState)(""),[h,g]=(0,c.useState)(null),[y,m]=(0,c.useState)(null),x="mutation lnInvoiceFeeProbe($input: LnInvoiceFeeProbeInput!) {\n  lnInvoiceFeeProbe(input: $input) {\n    errors {\n      message\n    }\n    amount\n  }\n}";(0,c.useEffect)((()=>{(0,d.lc)({operation:x,type:"feeProbe",setCurlCommand:u,authToken:e,apiEndpoint:n,walletId:t,paymentRequest:l})}),[e,n,l,t]);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontWeight:"bold"},children:"Set the variables"}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{children:[(0,a.jsx)("div",{children:"Invoice:"}),(0,a.jsx)("input",{type:"text",value:l,onChange:e=>o(e.target.value),style:{marginLeft:"10px",width:"50%"},placeholder:"Paste a lightning invoice"})]})}),(0,a.jsxs)("label",{children:[(0,a.jsx)("div",{children:"BTC wallet ID:"}),(0,a.jsx)("input",{type:"text",value:t,onChange:e=>{r(e.target.value)},style:{marginLeft:"10px",width:"50%"},placeholder:"Paste the BTC wallet ID from the response above"})]})]}),(0,a.jsx)("div",{style:{marginTop:"10px"}}),(0,a.jsx)("button",{onClick:async()=>{m(null),g(null);const a={input:{paymentRequest:l,walletId:t}};try{const r=await(0,p.t)(e,n,x,a);g(r),(0,d.lc)({operation:x,type:"feeProbe",setCurlCommand:u,authToken:e,apiEndpoint:n,walletId:t,paymentRequest:l})}catch(r){m(r.message)}},children:"Probe fee"}),(0,a.jsx)("div",{style:{marginTop:"10px"}}),y&&(0,a.jsxs)("div",{style:{color:"red"},children:["Error: ",y]}),h&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Response:"})," ",(0,a.jsx)("pre",{style:{marginLeft:"10px"},children:JSON.stringify(h,null,2)})]}),(0,a.jsxs)("div",{style:{marginTop:"20px",marginBottom:"40px"},children:[(0,a.jsx)("h4",{children:"curl command to probe invoice fee"}),(0,a.jsx)("div",{style:{marginTop:"10px"}}),(0,a.jsx)("pre",{style:{backgroundColor:"auto",padding:"10px",marginLeft:"10px",overflowX:"auto",whiteSpace:"pre-wrap"},children:s})]})]})}var h=t(4542);const g={id:"btc-ln-send",title:"Send BTC over Lightning",slug:"/api/legacy/btc-ln-send"},y=void 0,m={id:"api/legacy/btc-ln-send",title:"Send BTC over Lightning",description:"Get the wallet IDs and check the balances",source:"@site/docs/api/legacy/btc-ln-send.mdx",sourceDirName:"api/legacy",slug:"/api/legacy/btc-ln-send",permalink:"/api/legacy/btc-ln-send",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"btc-ln-send",title:"Send BTC over Lightning",slug:"/api/legacy/btc-ln-send"}},x={},v=[{value:"Get the wallet IDs and check the balances",id:"get-the-wallet-ids-and-check-the-balances",level:3},{value:"Estimate the payment fee (probe)",id:"estimate-the-payment-fee-probe",level:3},{value:"Pay a lightning invoice",id:"pay-a-lightning-invoice",level:3}];function j(e){const n={a:"a",admonition:"admonition",code:"code",h3:"h3",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,r.RP)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.O,{children:[(0,a.jsx)(l.a,{}),(0,a.jsx)(o.K,{}),(0,a.jsx)(n.h3,{id:"get-the-wallet-ids-and-check-the-balances",children:"Get the wallet IDs and check the balances"}),(0,a.jsxs)(n.p,{children:["Can run this query at any stage to confirm the change in the balances.",(0,a.jsx)("br",{}),'\nThe "BTC" wallet balance is denominated in satoshis.',(0,a.jsx)("br",{}),'\nThe "USD" wallet balance is in cents.']}),(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"The body of the GraphQL request"})}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-graphql",children:"query Me {\n  me {\n    defaultAccount {\n      wallets {\n        id\n        walletCurrency\n        balance\n      }\n    }\n  }\n}\n"})}),(0,a.jsx)(s.z,{}),(0,a.jsx)(n.hr,{}),(0,a.jsx)(n.h3,{id:"estimate-the-payment-fee-probe",children:"Estimate the payment fee (probe)"}),(0,a.jsxs)(n.p,{children:["Estimate the cost of paying a lightning invoice. ",(0,a.jsx)("br",{}),"\nPayments to an other Blink user and to nodes with a direct channel are free."]}),(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"The body of the GraphQL request"})}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-graphql",children:"mutation lnInvoiceFeeProbe($input: LnInvoiceFeeProbeInput!) {\n  lnInvoiceFeeProbe(input: $input) {\n    errors {\n      message\n    }\n    amount\n  }\n}\n"})}),(0,a.jsx)(u,{}),(0,a.jsx)(n.hr,{}),(0,a.jsx)(n.h3,{id:"pay-a-lightning-invoice",children:"Pay a lightning invoice"}),(0,a.jsx)(n.p,{children:"Pay a BOLT11 invoice from your BTC balance."}),(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"The body of the GraphQL request"})}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-graphql",children:"mutation LnInvoicePaymentSend($input: LnInvoicePaymentInput!) {\n  lnInvoicePaymentSend(input: $input) {\n    status\n    errors {\n      message\n      path\n      code\n    }\n  }\n}\n"})}),(0,a.jsx)(h.S,{})]}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.p,{children:["To test the GraphQL requests further use the GraphQL playground at ",(0,a.jsx)(n.a,{href:"https://api.blink.sv/graphql",children:"api.blink.sv/graphql"})," for mainnet or ",(0,a.jsx)(n.a,{href:"https://api.staging.galoy.io/graphql",children:"api.staging.galoy.io/graphql"})," for staging.",(0,a.jsx)("br",{}),"\nCheck out the ",(0,a.jsx)(n.a,{href:"https://documenter.getpostman.com/view/29391384/2s9YCAQq3z#ac3751d8-c116-408b-9129-d6e365da590b",children:"Galoy API Postman collection"})," to find examples in multiple programming languages."]})})]})}function f(e={}){const{wrapper:n}={...(0,r.RP)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(j,{...e})}):j(e)}},5680:(e,n,t)=>{t.d(n,{RP:()=>c});var a=t(6540);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),u=c(t),h=r,g=u["".concat(s,".").concat(h)]||u[h]||p[h]||i;return t?a.createElement(g,l(l({ref:n},d),{},{components:t})):a.createElement(g,l({ref:n},d))}));d.displayName="MDXCreateElement"},1276:(e,n,t)=>{t.d(n,{A:()=>l,O:()=>o});var a=t(6540),r=t(4848);const i=(0,a.createContext)(),l=()=>(0,a.useContext)(i),o=e=>{let{children:n}=e;const[t,l]=(0,a.useState)(null),[o,s]=(0,a.useState)("https://api.blink.sv/graphql"),[c,p]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),h={authToken:t,setAuthToken:l,apiEndpoint:o,setApiEndpoint:s,accountWalletId:c,setAccountWalletId:p,paymentRequest:d,setPaymentRequest:u};return(0,r.jsx)(i.Provider,{value:h,children:n})}},8415:(e,n,t)=>{t.d(n,{z:()=>s});var a=t(6540),r=t(4325),i=t(1276),l=t(2556),o=t(4848);function s(){const{authToken:e,apiEndpoint:n}=(0,i.A)(),[t,s]=(0,a.useState)(""),[c,p]=(0,a.useState)(null),[d,u]=(0,a.useState)(null),h="  query Me {\n    me {\n      defaultAccount {\n        wallets {\n          id\n          walletCurrency\n          balance\n        }\n      }\n    }\n  }";return(0,a.useEffect)((()=>{(0,l.lc)({operation:h,type:"wallet",setCurlCommand:s,authToken:e,apiEndpoint:n,walletCurrency:"BTC"})}),[e,n]),(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{onClick:async()=>{u(null),p(null);try{const t=await(0,r.t)(e,n,h);p(t),(0,l.lc)({operation:h,type:"wallet",setCurlCommand:s,authToken:e,apiEndpoint:n,walletCurrency:"BTC"})}catch(t){u(t.message)}},children:"Send the request"}),(0,o.jsx)("div",{style:{marginTop:"10px"}}),d&&(0,o.jsxs)("div",{style:{color:"red"},children:["Error: ",d]}),c&&(0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:"Response:"})," ",(0,o.jsx)("pre",{style:{marginLeft:"10px"},children:JSON.stringify(c,null,2)})]}),(0,o.jsxs)("div",{style:{marginTop:"20px",marginBottom:"40px"},children:[(0,o.jsx)("div",{style:{fontWeight:"bold"},children:"curl command to get the BTC wallet ID"}),(0,o.jsx)("div",{style:{marginTop:"10px"}}),(0,o.jsx)("pre",{style:{backgroundColor:"auto",padding:"10px",marginLeft:"10px",overflowX:"auto",whiteSpace:"pre-wrap"},children:t})]})]})}},4542:(e,n,t)=>{t.d(n,{S:()=>s});var a=t(6540),r=t(4325),i=t(1276),l=t(2556),o=t(4848);function s(){const{authToken:e,apiEndpoint:n,accountWalletId:t,setAccountWalletId:s,paymentRequest:c,setPaymentRequest:p}=(0,i.A)(),[d,u]=(0,a.useState)(""),[h,g]=(0,a.useState)(null),[y,m]=(0,a.useState)(null),x="mutation LnInvoicePaymentSend($input: LnInvoicePaymentInput!) {\n  lnInvoicePaymentSend(input: $input) {\n    status\n    errors {\n      message\n      path\n      code\n    }\n  }\n}";(0,a.useEffect)((()=>{(0,l.lc)({operation:x,type:"lnInvoicePaymentSend",setCurlCommand:u,authToken:e,apiEndpoint:n,walletId:t,paymentRequest:c})}),[e,n,c,t]);return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontWeight:"bold"},children:"Set the variables"}),(0,o.jsx)("div",{children:(0,o.jsxs)("label",{children:[(0,o.jsx)("div",{children:"Invoice:"}),(0,o.jsx)("input",{type:"text",value:c,onChange:e=>p(e.target.value),style:{marginLeft:"10px",width:"50%"},placeholder:"Paste a lightning invoice"})]})}),(0,o.jsxs)("label",{children:[(0,o.jsx)("div",{children:"BTC wallet ID:"}),(0,o.jsx)("input",{type:"text",value:t,onChange:e=>{s(e.target.value)},style:{marginLeft:"10px",width:"50%"},placeholder:"Paste the BTC wallet ID from the response above"})]})]}),(0,o.jsx)("div",{style:{marginTop:"10px"}}),(0,o.jsx)("button",{onClick:async()=>{m(null),g(null);const a={input:{paymentRequest:c,walletId:t}};try{const i=await(0,r.t)(e,n,x,a);g(i),(0,l.lc)({operation:x,type:"lnInvoicePaymentSend",setCurlCommand:u,authToken:e,apiEndpoint:n,walletId:t,paymentRequest:c})}catch(i){m(i.message)}},children:"Send payment"}),(0,o.jsx)("div",{style:{marginTop:"10px"}}),y&&(0,o.jsxs)("div",{style:{color:"red"},children:["Error: ",y]}),h&&(0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:"Response:"})," ",(0,o.jsx)("pre",{style:{marginLeft:"10px"},children:JSON.stringify(h,null,2)})]}),(0,o.jsxs)("div",{style:{marginTop:"20px"},children:[(0,o.jsx)("div",{style:{fontWeight:"bold"},children:"curl command to pay an invoice"}),(0,o.jsx)("div",{style:{marginTop:"10px"}}),(0,o.jsx)("pre",{style:{backgroundColor:"auto",padding:"10px",marginLeft:"10px",overflowX:"auto",whiteSpace:"pre-wrap"},children:d})]})]})}},2108:(e,n,t)=>{t.d(n,{a:()=>i});t(6540);var a=t(1276),r=t(4848);function i(){const{apiEndpoint:e,setApiEndpoint:n}=(0,a.A)();return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{children:"The GraphQL endpoint to connect to:"}),(0,r.jsxs)("select",{type:"text",value:e,onChange:e=>{n(e.target.value)},style:{width:"50%",marginBottom:"10px"},children:[(0,r.jsx)("option",{value:"https://api.blink.sv/graphql",children:"Blink (mainnet) - https://api.blink.sv/graphql"}),(0,r.jsx)("option",{value:"https://api.staging.galoy.io/graphql",children:"Staging (signet) - https://api.staging.galoy.io/graphql"})]})]})}},230:(e,n,t)=>{t.d(n,{K:()=>i});t(6540);var a=t(1276),r=t(4848);function i(){const{setAuthToken:e}=(0,a.A)();return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{children:"A valid authentication token is required in the header as a bearer token:"}),(0,r.jsx)("input",{type:"text",placeholder:"Paste the authentication token to use it",onChange:n=>{e(n.target.value)},style:{width:"50%",marginBottom:"10px"}})]})}},4325:(e,n,t)=>{t.d(n,{t:()=>a});const a=async function(e,n,t,a){if(void 0===a&&(a={}),!e)throw new Error("Not authenticated");if(!t)throw new Error("No GraphQL query provided");try{const r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`bearer ${e}`},body:JSON.stringify({query:t,variables:a})});if(!r.ok){const e=await r.text();throw new Error(`Error response from server: ${e}`)}const i=r.headers.get("content-type");if(i&&i.includes("application/json")){return await r.json()}throw new Error(`Unexpected content type: ${i}`)}catch(r){throw console.error("There was an error making the authenticated request:",r),r}}},2556:(e,n,t)=>{t.d(n,{Wg:()=>r,ZD:()=>a,cp:()=>i,lc:()=>l});const a=(e,n)=>{const t={email:n};return`curl -X POST '${e}/email/code' \\\n  --header 'Content-Type: application/json' \\\n  --header 'Accept: application/json' \\\n  --data '${JSON.stringify(t)}'`},r=(e,n,t)=>{const a={query:"mutation login($input: UserLoginInput!) { userLogin(input: $input) { authToken } }",variables:{input:{phone:n,code:t}}};return`curl '${e}' \\\n  --header 'Content-Type: application/json' \\\n  --header 'Accept: application/json' \\\n  --data-binary '${JSON.stringify(a)}'`},i=(e,n,t)=>`curl -X POST '${`${e}/email/login`}' \\\n  --header 'Content-Type: application/json' \\\n  --header 'Accept: application/json' \\\n  --data '${JSON.stringify({code:t,emailLoginId:n})}'`;function l(e){let{operation:n,type:t="",setCurlCommand:a,authToken:r,apiEndpoint:i,amount:l,paymentRequest:o="",walletId:s="",walletCurrency:c="",address:p}=e,d={query:n.trim(),variables:{}};const u=r?`--header 'Authorization: Bearer ${r}'`:"--header 'Authorization: Bearer <YOUR_AUTH_TOKEN_HERE>'";"invoice"===t?d.variables.input={amount:l.toString(),walletId:s}:"feeProbe"===t||"lnInvoicePaymentSend"===t?d.variables.input={paymentRequest:o,walletId:s}:"onChainTxFee"===t?d.variables={walletId:s,address:p,amount:l}:"onChainSend"===t&&(d.variables.input={walletId:s,address:p,amount:l});let h=JSON.stringify(d).replace(/\n/g,"");a("wallet"===t?`curl -sS --request POST --header 'content-type: application/json' \\\n  ${u} \\\n  --url '${i}' \\\n  --data '{"query":"query me { me { defaultAccount { wallets { id walletCurrency }}}}", "variables":{}}' \\\n| jq '.data.me.defaultAccount.wallets[] | select(.walletCurrency == "${c}") .id'`:`curl --request POST --header 'content-type: application/json' \\\n  ${u} \\\n  --url '${i}' \\\n  --data '${h}'`)}}}]);