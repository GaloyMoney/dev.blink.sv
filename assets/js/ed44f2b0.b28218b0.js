(self.webpackChunkdev_blink_sv=self.webpackChunkdev_blink_sv||[]).push([[26],{1089:(e,t,i)=>{"use strict";i.r(t),i.d(t,{assets:()=>x,contentTitle:()=>h,default:()=>y,frontMatter:()=>c,metadata:()=>p,toc:()=>m});var n=i(4848),s=i(8453),a=i(6540);const l=e=>{const[t,i]=(0,a.useState)(e?"loading":"idle");return(0,a.useEffect)((()=>{if(!e)return void i("idle");let t=document.querySelector(`script[src="${e}"]`);if(!t)return t=document.createElement("script"),t.src=e,t.async=!0,t.onload=()=>i("ready"),t.onerror=()=>i("error"),document.body.appendChild(t),()=>{document.body.removeChild(t)};i("ready")}),[e]),t};var d=i(1396),r=i.n(d);function o(){const[e,t]=(0,a.useState)(""),[i,s]=(0,a.useState)(""),[d,o]=(0,a.useState)(null),[c,h]=(0,a.useState)(null),[p,x]=(0,a.useState)({}),[m,g]=(0,a.useState)(null),[y,u]=(0,a.useState)(""),[v,j]=(0,a.useState)(!1),[f,b]=(0,a.useState)(!0),[w,k]=(0,a.useState)([]),[S,T]=(0,a.useState)(null),[N,L]=(0,a.useState)(""),[C,P]=(0,a.useState)(null),[$,D]=(0,a.useState)(!1);(0,a.useEffect)((()=>{const e=new URLSearchParams(window.location.search),i=e.get("invoice")||"",n=e.get("lnaddress")||"";i?t(i):n&&t(n)}),[]),(0,a.useEffect)((()=>{i&&""!==e&&i&&J(i)}),[i,e]);const H=l("/js/bolt11.min.js");if("loading"===H)return(0,n.jsx)("p",{children:"Loading script..."});if("error"===H)return(0,n.jsx)("p",{children:"Error loading script."});const W=()=>{try{let t,n;const s=i.toLowerCase();let a;s.startsWith("lnbc")?(t="mainnet",n={bech32:"bc",pubKeyHash:66,scriptHash:255,validWitnessVersions:[0,2,3,4,5]}):s.startsWith("lntbs")?(t="signet",n={bech32:"tbs",pubKeyHash:66,scriptHash:255,validWitnessVersions:[0,2,3,4,5]}):s.startsWith("lntb")&&(t="testnet",n={bech32:"tb",pubKeyHash:66,scriptHash:255,validWitnessVersions:[0,2,3,4,5]});try{a=lightningPayReq.decode(i,n),o(a);const e=a.tags.find((e=>"payment_hash"===e.tagName))?.data,s=new Date(1e3*a.timestamp),l=s.toISOString().replace("T"," ").replace(/\.\d{3}Z$/,"Z"),d=a.tags.find((e=>"expire_time"===e.tagName))?.data;let r;if(d){const e=new Date(s.getTime()+1e3*d),t=new Date;if(e<t){r=`expired since ${Math.round((t-e)/6e4)} minutes`}else{const i=Math.round(d/60);r=`${Math.round((e-t)/6e4)} minutes remaining out of ${i}`}}else r="N/A";const c=a.tags?.find((e=>"description"===e.tagName))?.data||"",p=a.tags?.some((e=>"routing_info"===e.tagName&&e.data&&e.data.length>0));let m=[];p&&(m=a.tags.filter((e=>"routing_info"===e.tagName)).flatMap((e=>e.data.map((e=>e.pubkey))))),x({invoice:a.paymentRequest,network:t,payeeNodeKey:a.payeeNodeKey,satoshis:a.satoshis,paymentHash:e,timestampString:l,expirationStatus:r,memo:c,link:_(a.payeeNodeKey,t),routingHintPubKeys:m}),"mainnet"===t&&a.payeeNodeKey?F(a.payeeNodeKey):a.payeeNodeKey?h({message:`No more details are fetched for ${t}`}):h(null),"mainnet"===t&&m.length>0?(k([]),m.forEach((e=>R(e)))):m.length>0?m.forEach((e=>k((i=>[...i,{hintPubkey:e,message:`No more details are fetched for ${t}`}])))):k([]),g(null)}catch(e){b(!1),console.error("Decoding failed: ",e.message),g("Decoding failed: "+e.message)}}catch(t){x({}),g("Failed to decode invoice. Please check the format.")}},_=(e,t)=>({mainnet:[{url:`https://mempool.space/lightning/node/${e}`,name:"mempool.space"},{url:`https://amboss.space/node/${e}`,name:"amboss.space"},{url:`https://1ml.com/node/${e}`,name:"1ml.com"},{url:`https://lightningnetwork.plus/nodes/${e}`,name:"lightningnetwork.plus"}],testnet:[{url:`https://mempool.space/${t}/lightning/node/${e}`,name:"mempool.space/testnet"},{url:`https://1ml.com/testnet/node/${e}`,name:"1ml.com/testnet"}],signet:[{url:`https://mempool.space/${t}/lightning/node/${e}`,name:"mempool.space/signet"}]}[t]||[]),F=async e=>{try{console.log(`Fetching node data for ${e}`);const t=await fetch(`https://mempool.space/api/v1/lightning/nodes/${e}`);if(!t.ok)throw h(null),new Error("Network response was not ok");const i=await t.json();"This node does not exist, or our node is not seeing it yet"===i.message?h(null):h(i)}catch(t){console.error("Failed to fetch node data:",t),h(null)}},R=async e=>{try{console.log(`Fetching routing hint data for ${e}`);const t=await fetch(`https://mempool.space/api/v1/lightning/nodes/${e}`);if(!t.ok)return void k((t=>[...t,{hintPubkey:e,message:"Network response was not ok"}]));const i=await t.json();"This node does not exist, or our node is not seeing it yet"===i.message?k((t=>[...t,{hintPubkey:e,message:"This node does not exist or the mempool.space node is not seeing it yet"}])):k((t=>[...t,{hintPubkey:e,...i}]))}catch(t){console.error("Failed to fetch routing hint data:",t),k((i=>[...i,{hintPubkey:e,message:`Failed to fetch routing hint data: ${t.toString()}`}]))}},K=async e=>{try{const[t,i]=e.split("@"),n=await fetch(`https://${i}/.well-known/lnurlp/${t}`);if(!n.ok)throw new Error("Network response was not ok");const s=await n.json();T(s)}catch(t){console.error("Failed to resolve lightning address:",t),g("Failed to resolve lightning address: "+t.message),T(null)}},E={display:"flex",marginBottom:"5px"},M={minWidth:"130px",fontWeight:"bold",marginLeft:"10px"},O={border:"none",background:"none",width:"100%",maxWidth:"500px",overflow:"auto",whiteSpace:"nowrap",fontSize:"inherit",fontFamily:"inherit",cursor:"pointer",outline:"none",textOverflow:"ellipsis"},A=e=>{navigator.clipboard.writeText(e).then((()=>{u("Copied to clipboard"),setTimeout((()=>{u("")}),2e3)}),(e=>{console.error("Could not copy text: ",e),u("Failed to copy to clipboard."),setTimeout((()=>{u("")}),2e3)}))},B=()=>{o(null),h(null),x({}),g(null),j(!1),b(!0),k([]),T(null)},I=()=>{s(""),t(""),L(""),D(!1),B()},J=()=>{B();i.toLowerCase().startsWith("ln")?W():i.includes("@")?K(i):g("Invalid input. Please enter a valid lightning invoice or lightning address.")};if(e&&!d&&f&&!S){(e=>{e.toLowerCase().startsWith("ln")?(s(e),W()):e.includes("@")&&K(e)})(e)}return(0,n.jsxs)("div",{children:[""===e&&(0,n.jsxs)("div",{children:[(0,n.jsx)("textarea",{value:i,onChange:e=>s(e.target.value),style:{width:"100%",maxWidth:"500px",height:"7em",overflow:"auto"},placeholder:"Paste a lightning invoice or a lightning address"}),(0,n.jsx)("br",{}),(0,n.jsx)("button",{onClick:J,children:"Decode"}),i&&(0,n.jsx)("button",{style:{marginLeft:"10px"},onClick:I,children:"Clear"})]}),e&&(0,n.jsxs)("div",{children:[(0,n.jsx)("input",{type:"text",value:e,style:O,readOnly:!0,onClick:()=>A(e),title:"Click to copy"}),(0,n.jsx)("br",{}),(0,n.jsx)("button",{style:{marginLeft:"10px"},onClick:I,children:"Clear"})]}),(0,n.jsx)("div",{style:{marginTop:"10px"}}),(()=>{if(!S)return null;const e={minWidth:"150px",fontWeight:"bold",marginLeft:"10px"};let t={};try{JSON.parse(S.metadata).forEach((e=>{"text/plain"===e[0]?t.description=e[1]:"text/identifier"===e[0]&&(t.lnaddress=e[1])}))}catch(i){console.error("Error parsing metadata:",i)}return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{children:"Lightning Address Data"}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:e,children:"Callback URL:"}),(0,n.jsx)("div",{children:S.callback})]}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:e,children:"Min Sendable:"}),(0,n.jsxs)("div",{children:[S.minSendable/1e3," sats"]})]}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:e,children:"Max Sendable:"}),(0,n.jsxs)("div",{children:[S.maxSendable/1e3," sats"]})]}),t.description&&(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:e,children:"Description:"}),(0,n.jsx)("div",{children:t.description})]}),t.lnaddress&&(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:e,children:"Lightning Address:"}),(0,n.jsx)("div",{children:t.lnaddress})]}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:e,children:"Comment Allowed:"}),(0,n.jsxs)("div",{children:[S.commentAllowed," characters"]})]}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:e,children:"Tag:"}),(0,n.jsx)("div",{children:S.tag})]}),S.allowsNostr&&(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:e,children:"Nostr:"}),(0,n.jsx)("div",{children:"Allowed"})]}),S.nostrPubkey&&(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:e,children:"Nostr Pubkey:"}),(0,n.jsx)("div",{children:S.nostrPubkey})]})]})})(),m&&(0,n.jsx)("div",{style:{color:"red"},children:m}),d&&(0,n.jsxs)("div",{children:[p&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{children:"Invoice data"}),(0,n.jsx)("div",{style:{marginTop:"10px"}}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:M,children:"network:"}),(0,n.jsx)("div",{children:p.network})]}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:M,children:"amount:"}),(0,n.jsxs)("div",{children:[p.satoshis," sats"]})]}),""!==p.memo&&(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:M,children:"description:"}),(0,n.jsx)("div",{children:p.memo})]}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:M,children:"expiry:"}),(0,n.jsx)("div",{children:p.expirationStatus})]}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:M,children:"created at:"}),(0,n.jsx)("div",{children:p.timestampString})]}),(0,n.jsx)("div",{style:M,children:"payment hash:"}),(0,n.jsx)("input",{type:"text",value:p.paymentHash,style:{...O,marginLeft:"20px"},readOnly:!0,onClick:()=>A(p.paymentHash),title:"Click to copy and scroll"}),w&&w.length>0&&(0,n.jsxs)("div",{style:{marginTop:"10px"},children:[(0,n.jsx)("h3",{children:"Routing Hint Data"}),w.map(((e,t)=>(0,n.jsxs)("div",{style:{marginBottom:"20px"},children:[!e.message&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:M,children:"alias:"}),(0,n.jsx)("div",{children:e.alias})]}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:M,children:"public channels:"}),(0,n.jsx)("div",{children:e.active_channel_count})]}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:M,children:"public capacity:"}),(0,n.jsxs)("div",{children:[e.capacity/1e8," btc"]})]}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:M,children:"last update:"}),(0,n.jsxs)("div",{children:[Math.round((Date.now()/1e3-e.updated_at)/60)," minutes ago"]})]})]}),(0,n.jsx)("div",{style:M,children:"public key:"}),(0,n.jsx)("input",{type:"text",value:e.hintPubkey,style:{...O,marginLeft:"20px"},readOnly:!0,onClick:()=>A(e.hintPubkey),title:"Click to copy and scroll"}),"038f8f113c580048d847d6949371726653e02b928196bad310e3eda39ff61723f6"===e.hintPubkey&&(0,n.jsx)("div",{style:{marginLeft:"10px",marginTop:"10px",marginBottom:"10px"},children:"This invoice was likely generated with Muun wallet."}),"03a6ce61fcaacd38d31d4e3ce2d506602818e3856b4b44faff1dde9642ba705976"===e.hintPubkey&&(0,n.jsx)("div",{style:{marginLeft:"10px",marginTop:"10px",marginBottom:"10px"},children:"This invoice was likely generated with Muun wallet."}),"03864ef025fde8fb587d989186ce6a4a186895ee44a926bfc370e2c366597a3f8f"===e.hintPubkey&&(0,n.jsx)("div",{style:{marginLeft:"10px",marginTop:"10px",marginBottom:"10px"},children:"This invoice was likely generated with Phoenix wallet."}),"03933884aaf1d6b108397e5efe5c86bcf2d8ca8d2f700eda99db9214fc2712b134"===e.hintPubkey&&(0,n.jsx)("div",{style:{marginLeft:"10px",marginTop:"10px",marginBottom:"10px"},children:"This invoice was likely generated with Phoenix wallet on testnet."}),e.message&&(0,n.jsx)("div",{style:E,children:(0,n.jsx)("div",{style:{marginLeft:"10px",marginTop:"10px",marginBottom:"10px"},children:e.message})}),(0,n.jsx)("div",{style:E,children:(0,n.jsx)("div",{style:M,children:"explore:"})}),(0,n.jsx)("div",{children:_(e.hintPubkey,p.network).map(((e,t)=>(0,n.jsx)("div",{style:{display:"inline-block",paddingLeft:"20px"},children:(0,n.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:e.name})},t)))})]},t)))]}),(0,n.jsx)("div",{style:{marginTop:"10px"}}),(0,n.jsx)("h3",{children:"Destination node data"}),c&&!c.message&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:M,children:"alias:"}),(0,n.jsx)("div",{children:c.alias})]}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:M,children:"public channels:"}),(0,n.jsx)("div",{children:c.active_channel_count})]}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:M,children:"public capacity:"}),(0,n.jsxs)("div",{children:[c.capacity/1e8," btc"]})]}),(0,n.jsxs)("div",{style:E,children:[(0,n.jsx)("div",{style:M,children:"last update:"}),(0,n.jsxs)("div",{children:[Math.round((Date.now()/1e3-c.updated_at)/60)," minutes ago"]})]})]}),(0,n.jsx)("div",{style:M,children:"public key:"}),(0,n.jsx)("input",{type:"text",value:p.payeeNodeKey,style:{...O,marginLeft:"20px"},readOnly:!0,onClick:()=>A(p.payeeNodeKey),title:"Click to copy and scroll"}),c&&c.message&&(0,n.jsx)("div",{style:{marginLeft:"10px",marginTop:"10px",marginBottom:"10px"},children:c.message}),c?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:E,children:(0,n.jsx)("div",{style:M,children:"explore:"})}),_(p.payeeNodeKey,p.network).map(((e,t)=>(0,n.jsx)("div",{style:{display:"inline-block",paddingLeft:"20px"},children:(0,n.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:e.name})},t)))]}):(0,n.jsx)("div",{style:{marginLeft:"10px",marginTop:"10px"},children:"No public data is available about this node"})]}),y&&(0,n.jsx)("div",{style:{position:"fixed",top:"20px",left:"50%",transform:"translateX(-50%)",backgroundColor:"orange",color:"black",padding:"10px",borderRadius:"10px",zIndex:1e3},children:y})]}),(0,n.jsxs)("div",{style:{marginTop:"20px"},children:[(d||S)&&(0,n.jsx)("button",{onClick:()=>{j(!v)},children:v?"Hide Raw Data":"Show Raw Data"}),v&&(0,n.jsxs)("div",{style:{marginTop:"20px"},children:[d&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{children:"Raw Invoice Data"}),(0,n.jsx)("pre",{style:{marginLeft:"10px",marginTop:"10px"},children:JSON.stringify(d,null,2)})]}),c&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{children:"Raw Node Data"}),(0,n.jsx)("pre",{style:{marginLeft:"10px",marginTop:"10px"},children:JSON.stringify(c,null,2)})]}),w&&w.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{children:"Raw Routing Hint Data"}),(0,n.jsx)("pre",{style:{marginLeft:"10px",marginTop:"10px"},children:JSON.stringify(w,null,2)})]}),S&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{children:"Raw Lightning Address Data"}),(0,n.jsx)("pre",{style:{marginLeft:"10px",marginTop:"10px"},children:JSON.stringify(S,null,2)})]})]})]}),p.paymentHash&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{style:{marginTop:"20px"},children:[(0,n.jsx)("h3",{children:"Know the preimage? Verify it below:"}),(0,n.jsx)("input",{type:"text",value:N,onChange:e=>L(e.target.value),placeholder:"Enter the preimage",style:{width:"100%",maxWidth:"500px"}}),(0,n.jsx)("div",{}),(0,n.jsx)("button",{onClick:()=>{try{const e=r().enc.Hex.parse(N),t=r().SHA256(e).toString(r().enc.Hex);t===p.paymentHash?(P("The preimage hashed matches the payment hash. This proves that the invoice was paid."),D(!0)):(P("The preimage hashed does not match the payment hash."),D(!1))}catch(e){g("Error verifying payment: "+e.message)}},children:"Verify Payment"})]}),C&&(0,n.jsx)("div",{style:{marginTop:"10px",color:$?"green":"red",fontWeight:"bold"},children:C})]})]})}const c={id:"decode",title:"Decode a lightning invoice",slug:"/decode"},h="LN invoice decoder",p={id:"decode",title:"Decode a lightning invoice",description:"Using the bolt11 nodejs package in the browser.",source:"@site/docs/decode.mdx",sourceDirName:".",slug:"/decode",permalink:"/decode",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"decode",title:"Decode a lightning invoice",slug:"/decode"}},x={},m=[];function g(e){const t={a:"a",h1:"h1",p:"p",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"ln-invoice-decoder",children:"LN invoice decoder"}),"\n","\n","\n",(0,n.jsx)(o,{}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(t.p,{children:["Using the ",(0,n.jsx)(t.a,{href:"https://www.npmjs.com/package/bolt11",children:"bolt11 nodejs package"})," in the browser.",(0,n.jsx)("br",{}),"\nThe destination node data is queried from the ",(0,n.jsx)(t.a,{href:"https://mempool.space/docs/api/rest#get-node-stats",children:"mempool.space API"}),"."]})]})}function y(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(g,{...e})}):g(e)}},477:()=>{}}]);