"use strict";(self.webpackChunkdev_blink_sv=self.webpackChunkdev_blink_sv||[]).push([[645],{4095:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>u,default:()=>m,frontMatter:()=>h,metadata:()=>d,toc:()=>g});var o=n(4848),a=n(5680),r=n(1276),i=n(6540);var s=n(2556);const l=function(){const{authToken:e,setAuthToken:t}=(0,r.A)(),[n,a]=(0,i.useState)("https://api.blink.sv/auth"),[l,c]=(0,i.useState)(""),[h,u]=(0,i.useState)(""),[d,p]=(0,i.useState)(null),[g,y]=(0,i.useState)(null),[m,x]=(0,i.useState)(""),[j,v]=(0,i.useState)(!1),[f,w]=(0,i.useState)(null),[b,k]=(0,i.useState)(null),[T,S]=(0,i.useState)(""),[O,C]=(0,i.useState)(""),[E,P]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{const e=(0,s.ZD)(n,l);S(e)}),[n,l]),(0,i.useEffect)((()=>{const e=(0,s.cp)(n,m,h);C(e)}),[n,m,h]),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{children:"1) Request a 2FA code to your email"}),(0,o.jsx)("div",{style:{marginTop:"10px"}}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{children:"The REST authentication endpoint to connect to:"}),(0,o.jsxs)("select",{type:"text",value:n,onChange:e=>a(e.target.value),style:{width:"50%",marginBottom:"10px"},children:[(0,o.jsx)("option",{value:"https://api.blink.sv/auth",children:"Blink (mainnet) - https://api.blink.sv/auth"}),(0,o.jsx)("option",{value:"https://api.staging.galoy.io/auth",children:"Staging (signet) - https://api.staging.galoy.io/auth"})]}),(0,o.jsx)("div",{}),(0,o.jsx)("input",{type:"email",placeholder:"Fill in the email address used for the account",value:l,onChange:e=>c(e.target.value),style:{width:"50%",marginBottom:"10px"}})]}),(0,o.jsx)("button",{onClick:async()=>{y(null),p(null);try{const e=await(async(e,t)=>{try{const n=await fetch(`${e}/email/code`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:t})}),o=await n.json();if(!n.ok)throw new Error(`HTTP Error: ${n.status}`);return o.result}catch(n){throw console.error("There was an error making the request:",n),n}})(n,l);x(e),p(`The emailLoginId: ${e} was obtained successfully! Check your email for the code.`)}catch(e){y(e.message)}},children:"Request code"}),(0,o.jsxs)("div",{style:{marginTop:"20px"},children:[(0,o.jsx)("h4",{children:"curl command to request an email code"}),(0,o.jsx)("pre",{style:{backgroundColor:"auto",padding:"10px",marginLeft:"10px",overflowX:"auto",whiteSpace:"pre-wrap"},children:T})]}),g&&(0,o.jsxs)("div",{style:{color:"red"},children:["Error: ",g]}),d&&(0,o.jsx)("div",{style:{color:"green"},children:d}),(0,o.jsx)("div",{style:{margin:"20px 0"}}),(0,o.jsxs)("div",{style:{marginTop:"40px"},children:[(0,o.jsx)("h3",{children:"2) Enter the 2FA code received by email"}),"The email login ID from the previous request:",(0,o.jsxs)("div",{children:[(0,o.jsx)("input",{type:"text",placeholder:"Email login ID",value:m,onChange:e=>x(e.target.value),style:{width:"50%",marginBottom:"10px"}}),(0,o.jsx)("div",{}),(0,o.jsx)("input",{type:"text",placeholder:"Fill in the code from the email",value:h,onChange:e=>u(e.target.value),style:{width:"50%",marginBottom:"10px"}})]}),(0,o.jsx)("button",{onClick:async()=>{if(k(null),w(null),!m||h.length<6)k("Invalid input");else{P(!0);try{const e=await(async(e,t,n)=>{try{const o=await fetch(`${e}/email/login`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({code:n,emailLoginId:t})}),a=await o.json();if(a.error){if("too many requests"===a.error)throw new Error("You've made too many requests. Please wait and try again later.");throw new Error(a.error)}if(!a.result?.authToken)throw new Error("Expected authToken not found in the response.");return a.result.authToken}catch(o){throw console.error("There was an error making the request:",o),o}})(n,m,h);t(e),w("Logged in successfully! Find your token below.")}catch(e){k(e.message)}finally{P(!1)}}},disabled:E,children:E?"Logging in...":"Log in to get your token"})]}),(0,o.jsxs)("div",{style:{marginTop:"20px"},children:[(0,o.jsx)("h4",{children:"curl command for email login"}),(0,o.jsx)("pre",{style:{backgroundColor:"auto",padding:"10px",marginLeft:"10px",overflowX:"auto",whiteSpace:"pre-wrap"},children:O})]}),b&&(0,o.jsxs)("div",{style:{color:"red"},children:["Error: ",b]}),f&&(0,o.jsx)("div",{style:{color:"green"},children:f}),e&&(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{onClick:()=>{v((e=>!e))},children:"Click to show your Authentication token"}),j&&(0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:"Token:"})," ",e]})]}),(0,o.jsx)("div",{style:{marginTop:"20px"}})]})};const c=function(){const{authToken:e,setAuthToken:t}=(0,r.A)(),[n,a]=(0,i.useState)("https://api.blink.sv/graphql"),[l,c]=(0,i.useState)(""),[h,u]=(0,i.useState)(""),[d,p]=(0,i.useState)(!1),[g,y]=(0,i.useState)(null),[m,x]=(0,i.useState)(null),[j,v]=(0,i.useState)("");return(0,i.useEffect)((()=>{v((0,s.Wg)(n,l,h))}),[l,h,n]),(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{children:"Log in with phone and code"}),(0,o.jsx)("div",{children:"The GraphQL endpoint to connect to:"}),(0,o.jsxs)("select",{type:"text",value:n,onChange:e=>{a(e.target.value)},style:{width:"50%",marginBottom:"10px"},children:[(0,o.jsx)("option",{value:"https://api.blink.sv/graphql",children:"Blink (mainnet) - https://api.blink.sv/graphql"}),(0,o.jsx)("option",{value:"https://api.staging.galoy.io/graphql",children:"Staging (signet) - https://api.staging.galoy.io/graphql"})]}),(0,o.jsx)("div",{}),(0,o.jsx)("input",{type:"text",placeholder:"Phone",value:l,onChange:e=>{c(e.target.value)}}),(0,o.jsx)("div",{}),(0,o.jsx)("input",{type:"text",placeholder:"Code",value:h,onChange:e=>{u(e.target.value)}}),(0,o.jsx)("div",{}),(0,o.jsx)("button",{onClick:async()=>{if(x(null),y(null),l.length<10||h.length<6)x("Invalid input");else try{const e=await(async(e,t,n)=>{try{const o=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:"\n            mutation login($input: UserLoginInput!) {\n              userLogin(input: $input) {\n                authToken\n              }\n            }\n          ",variables:{input:{phone:t,code:n}}})}),a=await o.text();console.log("Raw Response:",a);const r=JSON.parse(a);if(!o.ok)throw new Error(`HTTP Error: ${o.status}`);if(r.errors&&r.errors.length>0)throw new Error(r.errors[0].message);if(!r.data?.userLogin?.authToken)throw new Error("Expected authToken not found in the response.");return r.data.userLogin.authToken}catch(o){throw console.error("There was an error making the request:",o),o}})(n,l,h);t(e),y("Got the auth token!"),v((0,s.Wg)(n,l,h))}catch(e){x(e.message)}},children:"Log in"})]}),(0,o.jsxs)("div",{style:{marginTop:"20px"},children:[(0,o.jsx)("h3",{children:"curl command for phone login"}),(0,o.jsx)("pre",{style:{backgroundColor:"auto",padding:"10px",marginLeft:"10px",overflowX:"auto",whiteSpace:"pre-wrap"},children:j})]}),g&&(0,o.jsx)("div",{style:{color:"green"},children:g}),m&&(0,o.jsxs)("div",{style:{color:"red"},children:["Error: ",m]}),e&&(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{onClick:()=>{p((e=>!e))},children:"Toggle Token Visibility"}),d&&(0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:"Token:"})," ",e]})]})]})},h={id:"auth",title:"Authentication",slug:"/api/legacy/auth"},u=void 0,d={id:"api/legacy/auth",title:"Authentication",description:"There are multiple ways to obtain an auth token to be used with the API.",source:"@site/docs/api/legacy/auth.mdx",sourceDirName:"api/legacy",slug:"/api/legacy/auth",permalink:"/api/legacy/auth",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"auth",title:"Authentication",slug:"/api/legacy/auth"}},p={},g=[{value:"Log in with email through the REST API",id:"log-in-with-email-through-the-rest-api",level:2},{value:"Log in with phone and code",id:"log-in-with-phone-and-code",level:2},{value:"Copy the authentication token from the Blink app",id:"copy-the-authentication-token-from-the-blink-app",level:2}];function y(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",ul:"ul",...(0,a.RP)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:"There are multiple ways to obtain an auth token to be used with the API."}),"\n",(0,o.jsx)(t.h2,{id:"log-in-with-email-through-the-rest-api",children:"Log in with email through the REST API"}),"\n",(0,o.jsx)(t.admonition,{type:"tip",children:(0,o.jsxs)(t.p,{children:["Make sure you have ",(0,o.jsx)(t.a,{href:"/api/start#add-an-email-address",children:"registered your email address"})," in the Blink app to use this method."]})}),"\n",(0,o.jsx)(r.O,{children:(0,o.jsx)(l,{})}),"\n",(0,o.jsx)(t.admonition,{type:"caution",children:(0,o.jsxs)(t.p,{children:["The authentication token provides access to your wallet balance, save it securely as a password.\nUse it to make authenticated requests on the next pages or set it in the header as ",(0,o.jsx)(t.code,{children:"Authorization"})," ",(0,o.jsx)(t.code,{children:"Bearer <ory_token>"}),"."]})}),"\n",(0,o.jsx)(t.hr,{}),"\n",(0,o.jsx)(t.h2,{id:"log-in-with-phone-and-code",children:"Log in with phone and code"}),"\n",(0,o.jsx)(t.p,{children:"Get a 2FA code to your phone number in the Blink app or the Dashboard and use it to log in."}),"\n",(0,o.jsx)(r.O,{children:(0,o.jsx)(c,{})}),"\n",(0,o.jsx)(t.hr,{}),"\n",(0,o.jsx)(t.h2,{id:"copy-the-authentication-token-from-the-blink-app",children:"Copy the authentication token from the Blink app"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"Create new account"}),", ",(0,o.jsx)(t.code,{children:"Start with trial account"})," or ",(0,o.jsx)(t.code,{children:"Log back in with Phone or Email"})]}),"\n",(0,o.jsx)(t.li,{children:"tap the menu on the top right and scroll down"}),"\n",(0,o.jsx)(t.li,{children:"select the build number on the bottom 3 times"}),"\n",(0,o.jsxs)(t.li,{children:["select ",(0,o.jsx)(t.code,{children:"Copy access token"})," to save the token to your phone clipboard"]}),"\n"]})]})}function m(e={}){const{wrapper:t}={...(0,a.RP)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(y,{...e})}):y(e)}},5680:(e,t,n)=>{n.d(t,{RP:()=>c});var o=n(6540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},h={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(n),p=a,g=d["".concat(l,".").concat(p)]||d[p]||h[p]||r;return n?o.createElement(g,i(i({ref:t},u),{},{components:n})):o.createElement(g,i({ref:t},u))}));u.displayName="MDXCreateElement"},1276:(e,t,n)=>{n.d(t,{A:()=>i,O:()=>s});var o=n(6540),a=n(4848);const r=(0,o.createContext)(),i=()=>(0,o.useContext)(r),s=e=>{let{children:t}=e;const[n,i]=(0,o.useState)(null),[s,l]=(0,o.useState)("https://api.blink.sv/graphql"),[c,h]=(0,o.useState)(""),[u,d]=(0,o.useState)(""),p={authToken:n,setAuthToken:i,apiEndpoint:s,setApiEndpoint:l,accountWalletId:c,setAccountWalletId:h,paymentRequest:u,setPaymentRequest:d};return(0,a.jsx)(r.Provider,{value:p,children:t})}},2556:(e,t,n)=>{n.d(t,{Wg:()=>a,ZD:()=>o,cp:()=>r,lc:()=>i});const o=(e,t)=>{const n={email:t};return`curl -X POST '${e}/email/code' \\\n  --header 'Content-Type: application/json' \\\n  --header 'Accept: application/json' \\\n  --data '${JSON.stringify(n)}'`},a=(e,t,n)=>{const o={query:"mutation login($input: UserLoginInput!) { userLogin(input: $input) { authToken } }",variables:{input:{phone:t,code:n}}};return`curl '${e}' \\\n  --header 'Content-Type: application/json' \\\n  --header 'Accept: application/json' \\\n  --data-binary '${JSON.stringify(o)}'`},r=(e,t,n)=>`curl -X POST '${`${e}/email/login`}' \\\n  --header 'Content-Type: application/json' \\\n  --header 'Accept: application/json' \\\n  --data '${JSON.stringify({code:n,emailLoginId:t})}'`;function i(e){let{operation:t,type:n="",setCurlCommand:o,authToken:a,apiEndpoint:r,amount:i,paymentRequest:s="",walletId:l="",walletCurrency:c="",address:h}=e,u={query:t.trim(),variables:{}};const d=a?`--header 'Authorization: Bearer ${a}'`:"--header 'Authorization: Bearer <YOUR_AUTH_TOKEN_HERE>'";"invoice"===n?u.variables.input={amount:i.toString(),walletId:l}:"feeProbe"===n||"lnInvoicePaymentSend"===n?u.variables.input={paymentRequest:s,walletId:l}:"onChainTxFee"===n?u.variables={walletId:l,address:h,amount:i}:"onChainSend"===n&&(u.variables.input={walletId:l,address:h,amount:i});let p=JSON.stringify(u).replace(/\n/g,"");o("wallet"===n?`curl -sS --request POST --header 'content-type: application/json' \\\n  ${d} \\\n  --url '${r}' \\\n  --data '{"query":"query me { me { defaultAccount { wallets { id walletCurrency }}}}", "variables":{}}' \\\n| jq '.data.me.defaultAccount.wallets[] | select(.walletCurrency == "${c}") .id'`:`curl --request POST --header 'content-type: application/json' \\\n  ${d} \\\n  --url '${r}' \\\n  --data '${p}'`)}}}]);